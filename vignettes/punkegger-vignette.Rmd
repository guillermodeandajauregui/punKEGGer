---
title: "punKEGGer: parsing and visualization of KEGG pathways for network science"
author: "Guillermo de Anda Jáuregui"
date: "2025-07-22"
output:
  BiocStyle::html_document:
    toc: true
    toc_depth: 2
    number_sections: true
vignette: >
  %\VignetteIndexEntry{punKEGGer: parsing and visualization of KEGG pathways for network science}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(punKEGGer)
```

# 1 Introduction

`punKEGGer` was created to make KEGG pathway data accessible and useful for network science workflows.

Traditional approaches to KEGG data within Bioconductor often reduce pathways to simple gene sets (e.g., for enrichment analysis), custom-saved `graphNEL` objects, or static visualizations with hardcoded layouts. While those are valid for many use cases, they often lose the rich topological and visual information encoded in KEGG's own pathway representations.

`punKEGGer` provides a different approach: it parses the original `.kgml` files and converts them into clean, annotated `igraph` objects, with optional layouts and metadata preserved. From there, you can analyze topological features, integrate identifiers, combine multiple pathways, or run dynamic simulations — whatever your network science questions demand.

# 2 Example 1: Parse a single KEGG pathway

```{r example-1}
g <- parse_kegg_pathway("hsa04910")
g
```

# 3 Example 2: Add gene annotations

```{r example-2}
dict <- create_meta_dict(g)
dict_annotated <- annotate_kegg_graph(dict)
head(dict_annotated)
```

# 4 Example 3: Visualize your pathway

Reproduce KEGG-style layout:

```{r example-3a}
layout_tbl <- layout_kegg("hsa04910")
ggkegg(g, layout_tbl)
```

Or a force-directed layout with `ggraph`:

```{r example-3b}
library(ggraph)
library(tidygraph)

g_tbl <- as_tbl_graph(g)
ggraph(g_tbl, layout = "fr") +
  geom_edge_link() +
  geom_node_point(aes(color = type)) +
  theme_void()
```

# 5 Example 4: Combine pathways and do real network science

```{r example-4}
g1 <- parse_kegg_pathway("hsa05200") # Pathways in cancer
g2 <- parse_kegg_pathway("hsa05210") # Colorectal cancer
g3 <- parse_kegg_pathway("hsa05230") # Central carbon metabolism in cancer

g_combined <- combine_kegg_network(list(g1, g2, g3))
g_combined
```

Now you're free to explore centrality, modularity, community structure, or dynamics — the network science way.
